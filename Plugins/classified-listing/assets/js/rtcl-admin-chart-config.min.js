!function(e){var t;function r(r,a){e("#rtcl-revenue-reports").length&&(t=new Chart("rtcl-revenue-reports",{type:"line",data:{labels:r,datasets:[{label:"Revenue",fill:!1,lineTension:0,backgroundColor:"rgba(50,50,255,1.0)",borderColor:"rgba(50,50,255, 0.3)",data:a}]},options:{legend:{display:!1}}}))}e(document).ready(function(){if(e("#rtcl-revenue-report-search").on("apply.daterangepicker",function(a,n){var c="M/D/Y",o=(e(this),n.startDate.format(c)),s=n.endDate.format(c),l=moment(o,c),u=moment(s,c).diff(l,"days"),i="daily";u>300?i="monthly":u>100&&(i="weekly");var f={action:"rtcl_revenue_order_search",start_date:o,end_date:s,chart_type:i,__rtcl_wpnonce:rtcl.__rtcl_wpnonce};e.ajax({url:rtcl.ajaxurl,data:f,type:"POST",success:function(e){var a=e.data,n=Object.keys(a).length,c=[],o=[];if(n>50)if("monthly"===i){var s=function(e){var t=[];for(var r in e)if(e.hasOwnProperty(r)){var a=new Date(r).toLocaleString("en-us",{month:"short",year:"numeric"});t[a]||(t[a]=0),t[a]+=e[r]}return t}(a);c=Object.keys(s),o=Object.values(s)}else{var l=function(e){var t=[],r=Object.keys(e)[0],a=Object.keys(e)[Object.keys(e).length-1];r=new Date(r),a=new Date(a);for(;r<=a;)t.push(new Date(r)),r.setDate(r.getDate()+7);t[t.length-1]!==a&&t.push(new Date(a));var n=[];return t.forEach(function(t){var r=0;Object.keys(e).forEach(function(a){new Date(a)<=t&&(r+=e[a],delete e[a])});var a=moment(t).format("D MMM, YYYY");n.push({date:a,price:r})}),n}(a);l.forEach(function(e){c.push(e.date),o.push(e.price)})}else c=Object.keys(a),o=Object.values(a);t.destroy(),r(c,o)},error:function(e){console.log(e.responseText)}})}),e("#rtcl-revenue-report-search").on("cancel.daterangepicker",function(t,r){e(this).val("")}),"function"==typeof Chart){var a=rtcl_chart_vars.last_week_order_price;r(Object.keys(a),Object.values(a))}})}(jQuery);
