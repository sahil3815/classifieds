import{i as de,g as he,a as fe}from"./chunks/helper.js";function w(t){t=t||{},google.maps.OverlayView.apply(this,arguments),this.content_=t.content||"",this.disableAutoPan_=t.disableAutoPan||!1,this.maxWidth_=t.maxWidth||0,this.pixelOffset_=t.pixelOffset||new google.maps.Size(0,0),this.position_=t.position||new google.maps.LatLng(0,0),this.zIndex_=t.zIndex||null,this.boxClass_=t.boxClass||"infoBox",this.boxStyle_=t.boxStyle||{},this.closeBoxMargin_=t.closeBoxMargin||"2px",this.closeBoxURL_=t.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",t.closeBoxURL===""&&(this.closeBoxURL_=""),this.infoBoxClearance_=t.infoBoxClearance||new google.maps.Size(1,1),typeof t.visible>"u"&&(typeof t.isHidden>"u"?t.visible=!0:t.visible=!t.isHidden),this.isHidden_=!t.visible,this.alignBottom_=t.alignBottom||!1,this.pane_=t.pane||"floatPane",this.enableEventPropagation_=t.enableEventPropagation||!1,this.div_=null,this.closeListener_=null,this.moveListener_=null,this.contextListener_=null,this.eventListeners_=null,this.fixedWidthSet_=null}w.prototype=new google.maps.OverlayView;w.prototype.createInfoBoxDiv_=function(){var t,e,r,i=this,n=function(s){s.cancelBubble=!0,s.stopPropagation&&s.stopPropagation()},a=function(s){s.returnValue=!1,s.preventDefault&&s.preventDefault(),i.enableEventPropagation_||n(s)};if(!this.div_){if(this.div_=document.createElement("div"),this.setBoxStyle_(),typeof this.content_.nodeType>"u"?this.div_.innerHTML=this.getCloseBoxImg_()+this.content_:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(this.content_)),this.getPanes()[this.pane_].appendChild(this.div_),this.addClickHandler_(),this.div_.style.width?this.fixedWidthSet_=!0:this.maxWidth_!==0&&this.div_.offsetWidth>this.maxWidth_?(this.div_.style.width=this.maxWidth_,this.div_.style.overflow="auto",this.fixedWidthSet_=!0):(r=this.getBoxWidths_(),this.div_.style.width=this.div_.offsetWidth-r.left-r.right+"px",this.fixedWidthSet_=!1),this.panBox_(this.disableAutoPan_),!this.enableEventPropagation_){for(this.eventListeners_=[],e=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],t=0;t<e.length;t++)this.eventListeners_.push(google.maps.event.addDomListener(this.div_,e[t],n));this.eventListeners_.push(google.maps.event.addDomListener(this.div_,"mouseover",function(s){this.style.cursor="default"}))}this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",a),google.maps.event.trigger(this,"domready")}};w.prototype.getCloseBoxImg_=function(){var t="";return this.closeBoxURL_!==""&&(t="<img",t+=" src='"+this.closeBoxURL_+"'",t+=" align=right",t+=" style='",t+=" position: relative;",t+=" cursor: pointer;",t+=" margin: "+this.closeBoxMargin_+";",t+="'>"),t};w.prototype.addClickHandler_=function(){var t;this.closeBoxURL_!==""?(t=this.div_.firstChild,this.closeListener_=google.maps.event.addDomListener(t,"click",this.getCloseClickHandler_())):this.closeListener_=null};w.prototype.getCloseClickHandler_=function(){var t=this;return function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(t,"closeclick"),t.close()}};w.prototype.panBox_=function(t){var e,r=0,i=0;if(!t&&(e=this.getMap(),e instanceof google.maps.Map)){e.getBounds().contains(this.position_)||e.setCenter(this.position_),e.getBounds();var n=e.getDiv(),a=n.offsetWidth,s=n.offsetHeight,l=this.pixelOffset_.width,o=this.pixelOffset_.height,d=this.div_.offsetWidth,u=this.div_.offsetHeight,c=this.infoBoxClearance_.width,h=this.infoBoxClearance_.height,f=this.getProjection().fromLatLngToContainerPixel(this.position_);f.x<-l+c?r=f.x+l-c:f.x+d+l+c>a&&(r=f.x+d+l+c-a),this.alignBottom_?f.y<-o+h+u?i=f.y+o-h-u:f.y+o+h>s&&(i=f.y+o+h-s):f.y<-o+h?i=f.y+o-h:f.y+u+o+h>s&&(i=f.y+u+o+h-s),r===0&&i===0||(e.getCenter(),e.panBy(r,i))}};w.prototype.setBoxStyle_=function(){var t,e;if(this.div_){this.div_.className=this.boxClass_,this.div_.style.cssText="",e=this.boxStyle_;for(t in e)e.hasOwnProperty(t)&&(this.div_.style[t]=e[t]);this.div_.style.WebkitTransform="translateZ(0)",typeof this.div_.style.opacity<"u"&&this.div_.style.opacity!==""&&(this.div_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+this.div_.style.opacity*100+')"',this.div_.style.filter="alpha(opacity="+this.div_.style.opacity*100+")"),this.div_.style.position="absolute",this.div_.style.visibility="hidden",this.zIndex_!==null&&(this.div_.style.zIndex=this.zIndex_)}};w.prototype.getBoxWidths_=function(){var t,e={top:0,bottom:0,left:0,right:0},r=this.div_;return document.defaultView&&document.defaultView.getComputedStyle?(t=r.ownerDocument.defaultView.getComputedStyle(r,""),t&&(e.top=parseInt(t.borderTopWidth,10)||0,e.bottom=parseInt(t.borderBottomWidth,10)||0,e.left=parseInt(t.borderLeftWidth,10)||0,e.right=parseInt(t.borderRightWidth,10)||0)):document.documentElement.currentStyle&&r.currentStyle&&(e.top=parseInt(r.currentStyle.borderTopWidth,10)||0,e.bottom=parseInt(r.currentStyle.borderBottomWidth,10)||0,e.left=parseInt(r.currentStyle.borderLeftWidth,10)||0,e.right=parseInt(r.currentStyle.borderRightWidth,10)||0),e};w.prototype.onRemove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)};w.prototype.draw=function(){this.createInfoBoxDiv_();var t=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=t.x+this.pixelOffset_.width+"px",this.alignBottom_?this.div_.style.bottom=-(t.y+this.pixelOffset_.height)+"px":this.div_.style.top=t.y+this.pixelOffset_.height+"px",this.isHidden_?this.div_.style.visibility="hidden":this.div_.style.visibility="visible"};w.prototype.setOptions=function(t){typeof t.boxClass<"u"&&(this.boxClass_=t.boxClass,this.setBoxStyle_()),typeof t.boxStyle<"u"&&(this.boxStyle_=t.boxStyle,this.setBoxStyle_()),typeof t.content<"u"&&this.setContent(t.content),typeof t.disableAutoPan<"u"&&(this.disableAutoPan_=t.disableAutoPan),typeof t.maxWidth<"u"&&(this.maxWidth_=t.maxWidth),typeof t.pixelOffset<"u"&&(this.pixelOffset_=t.pixelOffset),typeof t.alignBottom<"u"&&(this.alignBottom_=t.alignBottom),typeof t.position<"u"&&this.setPosition(t.position),typeof t.zIndex<"u"&&this.setZIndex(t.zIndex),typeof t.closeBoxMargin<"u"&&(this.closeBoxMargin_=t.closeBoxMargin),typeof t.closeBoxURL<"u"&&(this.closeBoxURL_=t.closeBoxURL),typeof t.infoBoxClearance<"u"&&(this.infoBoxClearance_=t.infoBoxClearance),typeof t.isHidden<"u"&&(this.isHidden_=t.isHidden),typeof t.visible<"u"&&(this.isHidden_=!t.visible),typeof t.enableEventPropagation<"u"&&(this.enableEventPropagation_=t.enableEventPropagation),this.div_&&this.draw()};w.prototype.setContent=function(t){this.content_=t,this.div_&&(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.fixedWidthSet_||(this.div_.style.width=""),typeof t.nodeType>"u"?this.div_.innerHTML=this.getCloseBoxImg_()+t:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(t)),this.fixedWidthSet_||(this.div_.style.width=this.div_.offsetWidth+"px",typeof t.nodeType>"u"?this.div_.innerHTML=this.getCloseBoxImg_()+t:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(t))),this.addClickHandler_()),google.maps.event.trigger(this,"content_changed")};w.prototype.setPosition=function(t){this.position_=t,this.div_&&this.draw(),google.maps.event.trigger(this,"position_changed")};w.prototype.setZIndex=function(t){this.zIndex_=t,this.div_&&(this.div_.style.zIndex=t),google.maps.event.trigger(this,"zindex_changed")};w.prototype.setVisible=function(t){this.isHidden_=!t,this.div_&&(this.div_.style.visibility=this.isHidden_?"hidden":"visible")};w.prototype.getContent=function(){return this.content_};w.prototype.getPosition=function(){return this.position_};w.prototype.getZIndex=function(){return this.zIndex_};w.prototype.getVisible=function(){var t;return typeof this.getMap()>"u"||this.getMap()===null?t=!1:t=!this.isHidden_,t};w.prototype.show=function(){this.isHidden_=!1,this.div_&&(this.div_.style.visibility="visible")};w.prototype.hide=function(){this.isHidden_=!0,this.div_&&(this.div_.style.visibility="hidden")};w.prototype.open=function(t,e){var r=this;e&&(this.position_=e.getPosition(),this.moveListener_=google.maps.event.addListener(e,"position_changed",function(){r.setPosition(this.getPosition())})),this.setMap(t),this.div_&&this.panBox_()};w.prototype.close=function(){var t;if(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.eventListeners_){for(t=0;t<this.eventListeners_.length;t++)google.maps.event.removeListener(this.eventListeners_[t]);this.eventListeners_=null}this.moveListener_&&(google.maps.event.removeListener(this.moveListener_),this.moveListener_=null),this.contextListener_&&(google.maps.event.removeListener(this.contextListener_),this.contextListener_=null),this.setMap(null)};w.prototype.getCloseBoxImg_=function(){return'<div class="closeInfoBox"><i class="rtcl-icon-cancel"></i></div>'};w.prototype.addClickHandler_=function(){const t=this.div_.firstChild;this.closeListener_=google.maps.event.addDomListener(t,"click",this.getCloseClickHandler_())};w.prototype.getCloseClickHandler_=function(){var t=this;return function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(t,"closeclick"),jQuery(".infoBox").trigger("mouseleave"),t.close()}};var pe=Object.getOwnPropertyNames,ge=Object.getOwnPropertySymbols,me=Object.prototype.hasOwnProperty;function V(t,e){return function(i,n,a){return t(i,n,a)&&e(i,n,a)}}function R(t){return function(r,i,n){if(!r||!i||typeof r!="object"||typeof i!="object")return t(r,i,n);var a=n.cache,s=a.get(r),l=a.get(i);if(s&&l)return s===i&&l===r;a.set(r,i),a.set(i,r);var o=t(r,i,n);return a.delete(r),a.delete(i),o}}function ve(t){return t?.[Symbol.toStringTag]}function K(t){return pe(t).concat(ge(t))}var ye=Object.hasOwn||(function(t,e){return me.call(t,e)});function B(t,e){return t===e||!t&&!e&&t!==t&&e!==e}var _e="__v",xe="__o",we="_owner",$=Object.getOwnPropertyDescriptor,J=Object.keys;function Ee(t,e,r){var i=t.length;if(e.length!==i)return!1;for(;i-- >0;)if(!r.equals(t[i],e[i],i,i,t,e,r))return!1;return!0}function Ce(t,e){return B(t.getTime(),e.getTime())}function Le(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function ke(t,e){return t===e}function Q(t,e,r){var i=t.size;if(i!==e.size)return!1;if(!i)return!0;for(var n=new Array(i),a=t.entries(),s,l,o=0;(s=a.next())&&!s.done;){for(var d=e.entries(),u=!1,c=0;(l=d.next())&&!l.done;){if(n[c]){c++;continue}var h=s.value,f=l.value;if(r.equals(h[0],f[0],o,c,t,e,r)&&r.equals(h[1],f[1],h[0],f[0],t,e,r)){u=n[c]=!0;break}c++}if(!u)return!1;o++}return!0}var Me=B;function be(t,e,r){var i=J(t),n=i.length;if(J(e).length!==n)return!1;for(;n-- >0;)if(!oe(t,e,r,i[n]))return!1;return!0}function P(t,e,r){var i=K(t),n=i.length;if(K(e).length!==n)return!1;for(var a,s,l;n-- >0;)if(a=i[n],!oe(t,e,r,a)||(s=$(t,a),l=$(e,a),(s||l)&&(!s||!l||s.configurable!==l.configurable||s.enumerable!==l.enumerable||s.writable!==l.writable)))return!1;return!0}function Ae(t,e){return B(t.valueOf(),e.valueOf())}function Oe(t,e){return t.source===e.source&&t.flags===e.flags}function X(t,e,r){var i=t.size;if(i!==e.size)return!1;if(!i)return!0;for(var n=new Array(i),a=t.values(),s,l;(s=a.next())&&!s.done;){for(var o=e.values(),d=!1,u=0;(l=o.next())&&!l.done;){if(!n[u]&&r.equals(s.value,l.value,s.value,l.value,t,e,r)){d=n[u]=!0;break}u++}if(!d)return!1}return!0}function Se(t,e){var r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(t[r]!==e[r])return!1;return!0}function Ie(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function oe(t,e,r,i){return(i===we||i===xe||i===_e)&&(t.$$typeof||e.$$typeof)?!0:ye(e,i)&&r.equals(t[i],e[i],i,i,t,e,r)}var Be="[object Arguments]",Pe="[object Boolean]",Te="[object Date]",qe="[object Error]",Re="[object Map]",je="[object Number]",De="[object Object]",Ne="[object RegExp]",Ue="[object Set]",ze="[object String]",We="[object URL]",Ze=Array.isArray,Y=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,ee=Object.assign,Ge=Object.prototype.toString.call.bind(Object.prototype.toString);function Fe(t){var e=t.areArraysEqual,r=t.areDatesEqual,i=t.areErrorsEqual,n=t.areFunctionsEqual,a=t.areMapsEqual,s=t.areNumbersEqual,l=t.areObjectsEqual,o=t.arePrimitiveWrappersEqual,d=t.areRegExpsEqual,u=t.areSetsEqual,c=t.areTypedArraysEqual,h=t.areUrlsEqual,f=t.unknownTagComparators;return function(p,g,m){if(p===g)return!0;if(p==null||g==null)return!1;var y=typeof p;if(y!==typeof g)return!1;if(y!=="object")return y==="number"?s(p,g,m):y==="function"?n(p,g,m):!1;var C=p.constructor;if(C!==g.constructor)return!1;if(C===Object)return l(p,g,m);if(Ze(p))return e(p,g,m);if(Y!=null&&Y(p))return c(p,g,m);if(C===Date)return r(p,g,m);if(C===RegExp)return d(p,g,m);if(C===Map)return a(p,g,m);if(C===Set)return u(p,g,m);var _=Ge(p);if(_===Te)return r(p,g,m);if(_===Ne)return d(p,g,m);if(_===Re)return a(p,g,m);if(_===Ue)return u(p,g,m);if(_===De)return typeof p.then!="function"&&typeof g.then!="function"&&l(p,g,m);if(_===We)return h(p,g,m);if(_===qe)return i(p,g,m);if(_===Be)return l(p,g,m);if(_===Pe||_===je||_===ze)return o(p,g,m);if(f){var E=f[_];if(!E){var L=ve(p);L&&(E=f[L])}if(E)return E(p,g,m)}return!1}}function He(t){var e=t.circular,r=t.createCustomConfig,i=t.strict,n={areArraysEqual:i?P:Ee,areDatesEqual:Ce,areErrorsEqual:Le,areFunctionsEqual:ke,areMapsEqual:i?V(Q,P):Q,areNumbersEqual:Me,areObjectsEqual:i?P:be,arePrimitiveWrappersEqual:Ae,areRegExpsEqual:Oe,areSetsEqual:i?V(X,P):X,areTypedArraysEqual:i?P:Se,areUrlsEqual:Ie,unknownTagComparators:void 0};if(r&&(n=ee({},n,r(n))),e){var a=R(n.areArraysEqual),s=R(n.areMapsEqual),l=R(n.areObjectsEqual),o=R(n.areSetsEqual);n=ee({},n,{areArraysEqual:a,areMapsEqual:s,areObjectsEqual:l,areSetsEqual:o})}return n}function Ve(t){return function(e,r,i,n,a,s,l){return t(e,r,l)}}function Ke(t){var e=t.circular,r=t.comparator,i=t.createState,n=t.equals,a=t.strict;if(i)return function(o,d){var u=i(),c=u.cache,h=c===void 0?e?new WeakMap:void 0:c,f=u.meta;return r(o,d,{cache:h,equals:n,meta:f,strict:a})};if(e)return function(o,d){return r(o,d,{cache:new WeakMap,equals:n,meta:void 0,strict:a})};var s={cache:void 0,equals:n,meta:void 0,strict:a};return function(o,d){return r(o,d,s)}}var te=O();O({strict:!0});O({circular:!0});O({circular:!0,strict:!0});O({createInternalComparator:function(){return B}});O({strict:!0,createInternalComparator:function(){return B}});O({circular:!0,createInternalComparator:function(){return B}});O({circular:!0,createInternalComparator:function(){return B},strict:!0});function O(t){t===void 0&&(t={});var e=t.circular,r=e===void 0?!1:e,i=t.createInternalComparator,n=t.createState,a=t.strict,s=a===void 0?!1:a,l=He(t),o=Fe(l),d=i?i(o):Ve(o);return Ke({circular:r,comparator:o,createState:n,equals:d,strict:s})}const re=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],N=1,T=8;class F{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,i]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const n=i>>4;if(n!==N)throw new Error(`Got v${n} data when expected v${N}.`);const a=re[i&15];if(!a)throw new Error("Unrecognized array type.");const[s]=new Uint16Array(e,2,1),[l]=new Uint32Array(e,4,1);return new F(l,s,a,e)}constructor(e,r=64,i=Float64Array,n){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=i,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const a=re.indexOf(this.ArrayType),s=e*2*this.ArrayType.BYTES_PER_ELEMENT,l=e*this.IndexArrayType.BYTES_PER_ELEMENT,o=(8-l%8)%8;if(a<0)throw new Error(`Unexpected typed array class: ${i}.`);n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,T,e),this.coords=new this.ArrayType(this.data,T+l+o,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(T+s+l+o),this.ids=new this.IndexArrayType(this.data,T,e),this.coords=new this.ArrayType(this.data,T+l+o,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(N<<4)+a]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){const i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=e,this.coords[this._pos++]=r,i}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return W(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,i,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:a,coords:s,nodeSize:l}=this,o=[0,a.length-1,0],d=[];for(;o.length;){const u=o.pop()||0,c=o.pop()||0,h=o.pop()||0;if(c-h<=l){for(let g=h;g<=c;g++){const m=s[2*g],y=s[2*g+1];m>=e&&m<=i&&y>=r&&y<=n&&d.push(a[g])}continue}const f=h+c>>1,v=s[2*f],p=s[2*f+1];v>=e&&v<=i&&p>=r&&p<=n&&d.push(a[f]),(u===0?e<=v:r<=p)&&(o.push(h),o.push(f-1),o.push(1-u)),(u===0?i>=v:n>=p)&&(o.push(f+1),o.push(c),o.push(1-u))}return d}within(e,r,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:a,nodeSize:s}=this,l=[0,n.length-1,0],o=[],d=i*i;for(;l.length;){const u=l.pop()||0,c=l.pop()||0,h=l.pop()||0;if(c-h<=s){for(let g=h;g<=c;g++)ie(a[2*g],a[2*g+1],e,r)<=d&&o.push(n[g]);continue}const f=h+c>>1,v=a[2*f],p=a[2*f+1];ie(v,p,e,r)<=d&&o.push(n[f]),(u===0?e-i<=v:r-i<=p)&&(l.push(h),l.push(f-1),l.push(1-u)),(u===0?e+i>=v:r+i>=p)&&(l.push(f+1),l.push(c),l.push(1-u))}return o}}function W(t,e,r,i,n,a){if(n-i<=r)return;const s=i+n>>1;ae(t,e,s,i,n,a),W(t,e,r,i,s-1,1-a),W(t,e,r,s+1,n,1-a)}function ae(t,e,r,i,n,a){for(;n>i;){if(n-i>600){const d=n-i+1,u=r-i+1,c=Math.log(d),h=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*h*(d-h)/d)*(u-d/2<0?-1:1),v=Math.max(i,Math.floor(r-u*h/d+f)),p=Math.min(n,Math.floor(r+(d-u)*h/d+f));ae(t,e,r,v,p,a)}const s=e[2*r+a];let l=i,o=n;for(q(t,e,i,r),e[2*n+a]>s&&q(t,e,i,n);l<o;){for(q(t,e,l,o),l++,o--;e[2*l+a]<s;)l++;for(;e[2*o+a]>s;)o--}e[2*i+a]===s?q(t,e,i,o):(o++,q(t,e,o,n)),o<=r&&(i=o+1),r<=o&&(n=o-1)}}function q(t,e,r,i){U(t,r,i),U(e,2*r,2*i),U(e,2*r+1,2*i+1)}function U(t,e,r){const i=t[e];t[e]=t[r],t[r]=i}function ie(t,e,r,i){const n=t-r,a=e-i;return n*n+a*a}const $e={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},ne=Math.fround||(t=>(e=>(t[0]=+e,t[0])))(new Float32Array(1)),S=2,A=3,z=4,b=5,le=6;class Je{constructor(e){this.options=Object.assign(Object.create($e),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:r,minZoom:i,maxZoom:n}=this.options;r&&console.time("total time");const a=`prepare ${e.length} points`;r&&console.time(a),this.points=e;const s=[];for(let o=0;o<e.length;o++){const d=e[o];if(!d.geometry)continue;const[u,c]=d.geometry.coordinates,h=ne(j(u)),f=ne(D(c));s.push(h,f,1/0,o,-1,1),this.options.reduce&&s.push(0)}let l=this.trees[n+1]=this._createTree(s);r&&console.timeEnd(a);for(let o=n;o>=i;o--){const d=+Date.now();l=this.trees[o]=this._createTree(this._cluster(l,o)),r&&console.log("z%d: %d clusters in %dms",o,l.numItems,+Date.now()-d)}return r&&console.timeEnd("total time"),this}getClusters(e,r){let i=((e[0]+180)%360+360)%360-180;const n=Math.max(-90,Math.min(90,e[1]));let a=e[2]===180?180:((e[2]+180)%360+360)%360-180;const s=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)i=-180,a=180;else if(i>a){const c=this.getClusters([i,n,180,s],r),h=this.getClusters([-180,n,a,s],r);return c.concat(h)}const l=this.trees[this._limitZoom(r)],o=l.range(j(i),D(s),j(a),D(n)),d=l.data,u=[];for(const c of o){const h=this.stride*c;u.push(d[h+b]>1?se(d,h,this.clusterProps):this.points[d[h+A]])}return u}getChildren(e){const r=this._getOriginId(e),i=this._getOriginZoom(e),n="No cluster with the specified id.",a=this.trees[i];if(!a)throw new Error(n);const s=a.data;if(r*this.stride>=s.length)throw new Error(n);const l=this.options.radius/(this.options.extent*Math.pow(2,i-1)),o=s[r*this.stride],d=s[r*this.stride+1],u=a.within(o,d,l),c=[];for(const h of u){const f=h*this.stride;s[f+z]===e&&c.push(s[f+b]>1?se(s,f,this.clusterProps):this.points[s[f+A]])}if(c.length===0)throw new Error(n);return c}getLeaves(e,r,i){r=r||10,i=i||0;const n=[];return this._appendLeaves(n,e,r,i,0),n}getTile(e,r,i){const n=this.trees[this._limitZoom(e)],a=Math.pow(2,e),{extent:s,radius:l}=this.options,o=l/s,d=(i-o)/a,u=(i+1+o)/a,c={features:[]};return this._addTileFeatures(n.range((r-o)/a,d,(r+1+o)/a,u),n.data,r,i,a,c),r===0&&this._addTileFeatures(n.range(1-o/a,d,1,u),n.data,a,i,a,c),r===a-1&&this._addTileFeatures(n.range(0,d,o/a,u),n.data,-1,i,a,c),c.features.length?c:null}getClusterExpansionZoom(e){let r=this._getOriginZoom(e)-1;for(;r<=this.options.maxZoom;){const i=this.getChildren(e);if(r++,i.length!==1)break;e=i[0].properties.cluster_id}return r}_appendLeaves(e,r,i,n,a){const s=this.getChildren(r);for(const l of s){const o=l.properties;if(o&&o.cluster?a+o.point_count<=n?a+=o.point_count:a=this._appendLeaves(e,o.cluster_id,i,n,a):a<n?a++:e.push(l),e.length===i)break}return a}_createTree(e){const r=new F(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let i=0;i<e.length;i+=this.stride)r.add(e[i],e[i+1]);return r.finish(),r.data=e,r}_addTileFeatures(e,r,i,n,a,s){for(const l of e){const o=l*this.stride,d=r[o+b]>1;let u,c,h;if(d)u=ce(r,o,this.clusterProps),c=r[o],h=r[o+1];else{const p=this.points[r[o+A]];u=p.properties;const[g,m]=p.geometry.coordinates;c=j(g),h=D(m)}const f={type:1,geometry:[[Math.round(this.options.extent*(c*a-i)),Math.round(this.options.extent*(h*a-n))]],tags:u};let v;d||this.options.generateId?v=r[o+A]:v=this.points[r[o+A]].id,v!==void 0&&(f.id=v),s.features.push(f)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,r){const{radius:i,extent:n,reduce:a,minPoints:s}=this.options,l=i/(n*Math.pow(2,r)),o=e.data,d=[],u=this.stride;for(let c=0;c<o.length;c+=u){if(o[c+S]<=r)continue;o[c+S]=r;const h=o[c],f=o[c+1],v=e.within(o[c],o[c+1],l),p=o[c+b];let g=p;for(const m of v){const y=m*u;o[y+S]>r&&(g+=o[y+b])}if(g>p&&g>=s){let m=h*p,y=f*p,C,_=-1;const E=((c/u|0)<<5)+(r+1)+this.points.length;for(const L of v){const x=L*u;if(o[x+S]<=r)continue;o[x+S]=r;const M=o[x+b];m+=o[x]*M,y+=o[x+1]*M,o[x+z]=E,a&&(C||(C=this._map(o,c,!0),_=this.clusterProps.length,this.clusterProps.push(C)),a(C,this._map(o,x)))}o[c+z]=E,d.push(m/g,y/g,1/0,E,-1,g),a&&d.push(_)}else{for(let m=0;m<u;m++)d.push(o[c+m]);if(g>1)for(const m of v){const y=m*u;if(!(o[y+S]<=r)){o[y+S]=r;for(let C=0;C<u;C++)d.push(o[y+C])}}}}return d}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,r,i){if(e[r+b]>1){const s=this.clusterProps[e[r+le]];return i?Object.assign({},s):s}const n=this.points[e[r+A]].properties,a=this.options.map(n);return i&&a===n?Object.assign({},a):a}}function se(t,e,r){return{type:"Feature",id:t[e+A],properties:ce(t,e,r),geometry:{type:"Point",coordinates:[Qe(t[e]),Xe(t[e+1])]}}}function ce(t,e,r){const i=t[e+b],n=i>=1e4?`${Math.round(i/1e3)}k`:i>=1e3?`${Math.round(i/100)/10}k`:i,a=t[e+le],s=a===-1?{}:Object.assign({},r[a]);return Object.assign(s,{cluster:!0,cluster_id:t[e+A],point_count:i,point_count_abbreviated:n})}function j(t){return t/360+.5}function D(t){const e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function Qe(t){return(t-.5)*360}function Xe(t){const e=(180-t*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function Ye(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}class k{static isAdvancedMarkerAvailable(e){return google.maps.marker&&e.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,r){this.isAdvancedMarker(e)?e.map=r:e.setMap(r)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(Number.isFinite(e.position.lat)&&Number.isFinite(e.position.lng))return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return this.isAdvancedMarker(e)?!0:e.getVisible()}}class Z{constructor({markers:e,position:r}){this.markers=[],e&&(this.markers=e),r&&(r instanceof google.maps.LatLng?this._position=r:this._position=new google.maps.LatLng(r))}get bounds(){if(this.markers.length===0&&!this._position)return;const e=new google.maps.LatLngBounds(this._position,this._position);for(const r of this.markers)e.extend(k.getPosition(r));return e}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>k.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(k.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}function G(t,e="assertion failed"){if(t==null)throw Error(e)}class et{constructor({maxZoom:e=16}){this.maxZoom=e}noop({markers:e}){return tt(e)}}const tt=t=>t.map(r=>new Z({position:k.getPosition(r),markers:[r]}));class rt extends et{constructor(e){var{maxZoom:r,radius:i=60}=e,n=Ye(e,["maxZoom","radius"]);super({maxZoom:r}),this.markers=[],this.clusters=[],this.state={zoom:-1},this.superCluster=new Je(Object.assign({maxZoom:this.maxZoom,radius:i},n))}calculate(e){let r=!1,i=e.map.getZoom();G(i),i=Math.round(i);const n={zoom:i};if(!te(e.markers,this.markers)){r=!0,this.markers=[...e.markers];const a=this.markers.map(s=>{const l=k.getPosition(s);return{type:"Feature",geometry:{type:"Point",coordinates:[l.lng(),l.lat()]},properties:{marker:s}}});this.superCluster.load(a)}return r||(this.state.zoom<=this.maxZoom||n.zoom<=this.maxZoom)&&(r=!te(this.state,n)),this.state=n,e.markers.length===0?(this.clusters=[],{clusters:this.clusters,changed:r}):(r&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:r})}cluster({map:e}){const r=e.getZoom();return G(r),this.superCluster.getClusters([-180,-90,180,90],Math.round(r)).map(i=>this.transformCluster(i))}transformCluster({geometry:{coordinates:[e,r]},properties:i}){if(i.cluster)return new Z({markers:this.superCluster.getLeaves(i.cluster_id,1/0).map(a=>a.properties.marker),position:{lat:r,lng:e}});const n=i.marker;return new Z({markers:[n],position:k.getPosition(n)})}}class it{constructor(e,r){this.markers={sum:e.length};const i=r.map(a=>a.count),n=i.reduce((a,s)=>a+s,0);this.clusters={count:r.length,markers:{mean:n/r.length,sum:n,min:Math.min(...i),max:Math.max(...i)}}}}class nt{render({count:e,position:r},i,n){const s=`<svg fill="${e>Math.max(10,i.clusters.markers.mean)?"#ff0000":"#0000ff"}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">${e}</text>
</svg>`,l=`Cluster of ${e} markers`,o=Number(google.maps.Marker.MAX_ZINDEX)+e;if(k.isAdvancedMarkerAvailable(n)){const c=new DOMParser().parseFromString(s,"image/svg+xml").documentElement;c.setAttribute("transform","translate(0 25)");const h={map:n,position:r,zIndex:o,title:l,content:c};return new google.maps.marker.AdvancedMarkerElement(h)}const d={position:r,zIndex:o,title:l,icon:{url:`data:image/svg+xml;base64,${btoa(s)}`,anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(d)}}function st(t,e){for(let r in e.prototype)t.prototype[r]=e.prototype[r]}class H{constructor(){st(H,google.maps.OverlayView)}}var I;(function(t){t.CLUSTERING_BEGIN="clusteringbegin",t.CLUSTERING_END="clusteringend",t.CLUSTER_CLICK="click",t.GMP_CLICK="gmp-click"})(I||(I={}));const ot=(t,e,r)=>{e.bounds&&r.fitBounds(e.bounds)};class at extends H{constructor({map:e,markers:r=[],algorithmOptions:i={},algorithm:n=new rt(i),renderer:a=new nt,onClusterClick:s=ot}){super(),this.map=null,this.idleListener=null,this.markers=[...r],this.clusters=[],this.algorithm=n,this.renderer=a,this.onClusterClick=s,e&&this.setMap(e)}addMarker(e,r){this.markers.includes(e)||(this.markers.push(e),r||this.render())}addMarkers(e,r){e.forEach(i=>{this.addMarker(i,!0)}),r||this.render()}removeMarker(e,r){const i=this.markers.indexOf(e);return i===-1?!1:(k.setMap(e,null),this.markers.splice(i,1),r||this.render(),!0)}removeMarkers(e,r){let i=!1;return e.forEach(n=>{i=this.removeMarker(n,!0)||i}),i&&!r&&this.render(),i}clearMarkers(e){this.markers.length=0,e||this.render()}render(){const e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,I.CLUSTERING_BEGIN,this);const{clusters:r,changed:i}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(i||i==null){const n=new Set;for(const s of r)s.markers.length==1&&n.add(s.markers[0]);const a=[];for(const s of this.clusters)s.marker!=null&&(s.markers.length==1?n.has(s.marker)||k.setMap(s.marker,null):a.push(s.marker));this.clusters=r,this.renderClusters(),requestAnimationFrame(()=>a.forEach(s=>k.setMap(s,null)))}google.maps.event.trigger(this,I.CLUSTERING_END,this)}}onAdd(){const e=this.getMap();G(e),this.idleListener=e.addListener("idle",this.render.bind(this)),this.render()}onRemove(){this.idleListener&&google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>k.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){const e=new it(this.markers,this.clusters),r=this.getMap();this.clusters.forEach(i=>{if(i.markers.length===1)i.marker=i.markers[0];else if(i.marker=this.renderer.render(i,e,r),i.markers.forEach(n=>k.setMap(n,null)),this.onClusterClick){const n=k.isAdvancedMarker(i.marker)?I.GMP_CLICK:I.CLUSTER_CLICK;i.marker.addListener(n,a=>{google.maps.event.trigger(this,I.CLUSTER_CLICK,i),this.onClusterClick(a,i,r)})}k.setMap(i.marker,r)})}}(function(t){let e=null;const r=new google.maps.Geocoder;t(function(){rtcl_render_map_view(),t(".rtcl-map").each(function(){rtcl_render_map(this)}),rtcl_startGeoAutoSuggestion(),rtcl_getCurrentLocation(),t(document).on("rtcl_ajax_filter_after_render",function(s,l){l.actionData.hasMap&&rtcl_render_map_view()})}),window.rtcl_getCurrentLocation=function(){t(".rtcl-get-location").on("click",function(){const s=t(this);s.hasClass("initiated")||(s.addClass("initiated"),navigator.geolocation?navigator.geolocation.getCurrentPosition(function(l){const o=l.coords.latitude,d=l.coords.longitude,u=s.parent(),c=u.find(".rtcl-geo-address-input");if(u.find("input.latitude").val(o),u.find("input.longitude").val(d),c.length){const h=new google.maps.LatLng(o,d);r.geocode({latLng:h},function(f,v){if(v===google.maps.GeocoderStatus.OK)if(f[0]){const p=f[0];c.val(p.formatted_address),rtcl_map.location==="geo"&&s.attr("id")==="rtcl-geo-loc-form"&&n(p.geometry.location),t(document).trigger("rtcl_map_retrieve_geocode",[{lat:p.geometry.location.lat(),lng:p.geometry.location.lng(),address:p.formatted_address,target:s[0]}])}else toastr.error("Address not found");else toastr.error("Geocoder failed due to: "+v)})}},function(l){switch(l.code){case l.PERMISSION_DENIED:toastr.error("User denied the request for Geolocation.");break;case l.POSITION_UNAVAILABLE:toastr.error("Location information is unavailable.");break;case l.TIMEOUT:toastr.error("The request to get user location timed out.");break;case l.UNKNOWN_ERROR:toastr.error("An unknown error occurred.");break;default:toastr.error("An unknown error occurred.");break}}):toastr.error("Geolocation is not supported by this browser."))})},window.rtcl_startGeoAutoSuggestion=function(){t(document).find(".rtcl-geo-address-input").each(function(){const s=t(this);this.autocomplete=de?"disabled":"off";const l=s.parent(),o=new google.maps.places.Autocomplete(this),d=document.createElement("div");d.style.display="none",document.body.appendChild(d);let u=new google.maps.Map(d);u=e&&s.hasClass("rtcl_geo_address_input")?e:u,o.bindTo("bounds",u),google.maps.event.addListener(o,"place_changed",function(){const c=o.getPlace();if(!c.geometry)return;s.val(c.formatted_address);const h=c.geometry.location.lat(),f=c.geometry.location.lng();l.find("input.latitude").val(h),l.find("input.longitude").val(f),t(document).trigger("rtcl_map_retrieve_geocode",[{lat:h,lng:f,address:c.formatted_address,target:s[0]}]),s.hasClass("rtcl_geo_address_input")&&(u.setCenter(c.geometry.location),u.setZoom(rtcl_map.zoom.search||17),u.markers&&u.markers.length&&(u.markers[0].setPosition(c.geometry.location),u.markers[0].iw&&(u.markers[0].iw.setContent(c.formatted_address),u.markers[0].iw.open())),n(c.geometry.location))}),google.maps.event.addDomListener(this,"keydown",function(c){c.keyCode===13&&t(".pac-container:visible").length&&c.preventDefault()})})},window.rtcl_render_map=function(s){const l=t(s),o=l.find(".marker"),d=new google.maps.LatLng(rtcl_map.center.lat||0,rtcl_map.center.lng||0),u=Object.assign({},{zoom:rtcl_map.zoom.default,center:d,mapTypeId:google.maps.MapTypeId.ROADMAP,zoomControl:!0,scrollwheel:!1},l.data("options")||{}),c={zoom:parseInt(u.zoom)||16,center:u.center,mapTypeId:u.mapTypeId,zoomControl:u.zoomControl,scrollwheel:u.scrollwheel},h=new google.maps.Map(s,c);h.markers=[],h.type=l.data("type"),h.type==="input"&&(e=h),o.each(function(){const f=t(this),v=f.data("latitude")||d.lat(),p=f.data("longitude")||d.lng(),g=f.data("latitude")&&f.data("longitude")?"":f.data("address"),m=new google.maps.LatLng(v,p),y=new google.maps.Marker({map:h,position:m,draggable:h.type==="input"});u.icon&&y.setIcon(u.icon),h.setCenter(m);const C=new google.maps.InfoWindow({content:f.html()});google.maps.event.addListener(y,"click",function(){C.open(h,y)}),y.iw=C,h.markers.push(y),g&&r.geocode({address:g},function(_,E){if(E===google.maps.GeocoderStatus.OK){const L=_[0];y.setPosition(L.geometry.location),h.setCenter(L.geometry.location),n(L.geometry.location),t(document).trigger("rtcl_map_retrieve_geocode",[{lat:L.geometry.location.lat(),lng:L.geometry.location.lng(),address:L.formatted_address}])}}),h.type==="input"&&(google.maps.event.addListener(y,"dragend",function(_){const E=y.getPosition();h.setCenter(E),h.setZoom(rtcl_map.zoom.search||17),n(E);const L=t("input.rtcl_geo_address_input");if(L.length){r.geocode({latLng:E},function(M,ue){ue===google.maps.GeocoderStatus.OK&&M[0]&&(L.val(M[0].formatted_address),y.iw.setContent(M[0].formatted_address))});const x=L.parent();x.find("input.latitude").val(E.lat()),x.find("input.longitude").val(E.lng())}}),rtcl_map.location==="local"&&(i(h),t(".rtcl-map-field").on("blur change keyup",function(){i(h)})))})};function i(s){const l=he();r.geocode({address:l},function(o,d){if(d===google.maps.GeocoderStatus.OK){const u=o[0].geometry.location;s.markers[0].setPosition(u),s.setCenter(u),s.setZoom(rtcl_map.zoom.search||17),n(u)}})}function n(s){t("#rtcl-latitude").val(s.lat()),t("#rtcl-longitude").val(s.lng())}window.rtcl_render_map_view=function(){const s=t(".rtcl-map-view");s.length&&s.each(function(){a(this)})};const a=function(s){const l=t(s),o={center:new google.maps.LatLng(0,0),zoom:3,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:""};let d=l.data("gmapInstance"),u=l.data("gmapMarkers")||[],c=l.data("gmapCluster");d?(u.forEach(C=>C.setMap(null)),c&&c.clearMarkers(),google.maps.event.clearInstanceListeners(d)):(d=new google.maps.Map(s,o),l.data("gmapInstance",d));const h=[],f=new google.maps.LatLngBounds,v=new w({enableEventPropagation:!0,maxWidth:350,infoBoxClearance:new google.maps.Size(50,50),alignBottom:!0,pixelOffset:new google.maps.Size(-47,-75)}),p=[],g=l.data("map-type")||"";let m=l.data("map-data")||[];g==="search"&&(m=fe()),m&&m.length&&t.each(m,function(C,_){const E=Object.assign({id:0,latitude:0,longitude:0,icon:"",content:""},_),L=new google.maps.LatLng(E.latitude,E.longitude);if(p.indexOf(E.id)===-1){p.push(E.id),f.extend(L);const x=new google.maps.Marker({position:L,icon:E.icon,map:d});x.content=E.content,x.addListener("click",function(){v.close(),v.setContent(x.content),v.setOptions({pixelOffset:new google.maps.Size(-47,-75)}),v.open(d,x)}),h.push(x)}});const y=new at({map:d,markers:h});y.addListener("click",C=>{v.close();const _=C.markers;let E=!0,L;for(let x=0;x<_.length;x++)L?L.equals(_[x].position)||(E=!1):L=_[x].position;if(E){let x='<ul class="list-unstyled info-box-markers-list">';_.forEach(M=>{x+=`<li>${M.content}</li>`}),x+="</ul>",v.setContent(x),v.setOptions({pixelOffset:new google.maps.Size(-45,-50)}),v.open(d,_[_.length-1]),setTimeout(()=>{t(".info-box-markers-list").scrollbar()},50)}else{const x=new google.maps.LatLngBounds;_.forEach(M=>x.extend(M.position)),d.fitBounds(x)}}),d.fitBounds(f),l.data("gmapMarkers",h),l.data("gmapCluster",y)}})(jQuery);
