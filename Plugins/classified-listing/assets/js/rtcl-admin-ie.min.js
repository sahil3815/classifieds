(()=>{function t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var r,n,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function s(t,o,i,a){var s=o&&o.prototype instanceof l?o:l,p=Object.create(s.prototype);return e(p,"_invoke",function(t,e,o){var i,a,s,l=0,p=o||[],u=!1,d={p:0,n:0,v:r,a:f,f:f.bind(r,4),d:function(t,e){return i=t,a=0,s=r,d.n=e,c}};function f(t,e){for(a=t,s=e,n=0;!u&&l&&!o&&n<p.length;n++){var o,i=p[n],f=d.p,m=i[2];t>3?(o=m===e)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=r):i[0]<=f&&((o=t<2&&f<i[1])?(a=0,d.v=e,d.n=i[1]):f<m&&(o=t<3||i[0]>e||e>m)&&(i[4]=t,i[5]=e,d.n=m,a=0))}if(o||t>1)return c;throw u=!0,e}return function(o,p,m){if(l>1)throw TypeError("Generator is already running");for(u&&1===p&&f(p,m),a=p,s=m;(n=a<2?r:s)||!u;){i||(a?a<3?(a>1&&(d.n=-1),f(a,s)):d.n=s:d.v=s);try{if(l=2,i){if(a||(o="next"),n=i[o]){if(!(n=n.call(i,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,a<2&&(a=0)}else 1===a&&(n=i.return)&&n.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=r}else if((n=(u=d.n<0)?s:t.call(e,d))!==c)break}catch(t){i=r,a=1,s=t}finally{l=1}}return{value:n,done:u}}}(t,i,a),!0),p}var c={};function l(){}function p(){}function u(){}n=Object.getPrototypeOf;var d=[][i]?n(n([][i]())):(e(n={},i,function(){return this}),n),f=u.prototype=l.prototype=Object.create(d);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,e(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return p.prototype=u,e(f,"constructor",u),e(u,"constructor",p),p.displayName="GeneratorFunction",e(u,a,"GeneratorFunction"),e(f),e(f,a,"Generator"),e(f,i,function(){return this}),e(f,"toString",function(){return"[object Generator]"}),(t=function(){return{w:s,m}})()}function e(t,r,n,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}e=function(t,r,n,o){function a(r,n){e(t,r,function(t){return this._invoke(r,n,t)})}r?i?i(t,r,{value:n,enumerable:!o,configurable:!o,writable:!o}):t[r]=n:(a("next",0),a("throw",1),a("return",2))},e(t,r,n,o)}function r(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function n(t){return function(){var e=this,n=arguments;return new Promise(function(o,i){var a=t.apply(e,n);function s(t){r(a,o,i,s,c,"next",t)}function c(t){r(a,o,i,s,c,"throw",t)}s(void 0)})}}!function(e){var r=e('<div class="response-item"><div class="progress"><div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div></div><div class="response"></div></div>'),o=[];if(e.fn.validate){var i=function(t){var e=void 0!==t?t.length:0;return e&&t.forEach(function(t,r){t.child&&(e+=i(t.child))}),e},a=function(){var o=n(t().m(function o(a,s,c){var l,p,u,d,f,m,v,g,h,b,y,w,_;return t().w(function(o){for(;;)switch(o.n){case 0:if(_=function(){return(_=n(t().m(function e(r,n){var o,i,a,s,c;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:if(void 0===r||!Array.isArray(r)||!r.length){t.n=8;break}o=0;case 1:if(!(o<r.length)){t.n=8;break}return i=r[o],n&&(i.parent=n),(a=Object.assign({},i)).child&&delete a.child,t.p=2,t.n=3,y(a);case 3:if(!(s=t.v).success||!i.child){t.n=4;break}return t.n=4,w(i.child,s.data.term_id);case 4:t.n=6;break;case 5:t.p=5,c=t.v,console.error("Error inserting item:",c);case 6:h===r.length&&m.prop("disabled",!1),h++;case 7:o++,t.n=1;break;case 8:return t.a(2)}},e,null,[[2,5]])}))).apply(this,arguments)},w=function(t,e){return _.apply(this,arguments)},y=function(t){return new Promise(function(r,n){e.ajax({url:rtcl.ajaxurl,method:"POST",data:{data:t,action:s,__rtcl_wpnonce:rtcl.__rtcl_wpnonce},dataType:"json",success:function(t){var e=d.find(".alert");b+=g,(l=Math.ceil(b))>100&&(l=100),f.text(l+"%"),f.width(b+"%"),t.success?e.append('<p style="color: green">'+t.message+"</p>"):e.append('<p style="color: red">'+t.message+"</p>"),b>99&&e.append("<p><strong>"+c+" Successfully Imported</strong></p>"),e.scrollTop(e[0].scrollHeight-e.outerHeight()),r(t)},error:function(t,e,r){b+=g,f.text(Math.ceil(b)+"%"),f.width(b+"%"),n(e)}})})},!a||a.length){o.n=1;break}return o.a(2);case 1:return l=0,p=e("#import-response"),u=r.clone(),d=e(".response",u),f=e(".progress-bar",u),m=e("#rtcl-import-btn"),v=i(a),g=100/v,h=1,b=0,u.prepend("<h5>"+c+" importing ...</h5>"),f.text("0%"),f.width("0%"),d.html("<div class='alert alert-info' style='height: 200px; overflow-y: scroll;'> Loading ....</div>"),p.append(u),m.prop("disabled",!0),o.n=2,w(a);case 2:return o.a(2)}},o)}));return function(t,e,r){return o.apply(this,arguments)}}();e("#rtcl-import-file").on("change",function(t){var r=e(this);r.parent(".custom-file").find(".custom-file-label").text(r.val()),e("#rtcl-import-form").validate()}),e(".rtcl-import-listing-file").on("change",function(t){var r=e(this);r.parent(".custom-file").find(".custom-file-label").text(r.val())}),e(document).on("click","#rtcl-import-listing-btn",function(t){t.preventDefault();var r=new FormData,n=e(this),i=e("#rtcl-import-listing-file"),a=i.prop("files")[0],s=e(".rtcl-listings-import-mapping-wrapper"),c="",l=e('<div id="rtcl-import-file-error" class="with-errors help-block"></div>'),p="Please, select a csv file to import listings data!";if(i.closest(".form-group").find("#rtcl-import-file-error").remove(),i.closest(".form-group").find(".rtcl-label").css("color","#3c434a"),!a)return l.text(p),l.insertAfter(i).show(),void i.closest(".form-group").find(".rtcl-label").css("color","red");"text/csv"===a.type||"application/csv"===a.type?(r.append("file",a),r.append("action","rtcl_import_listings"),r.append("__rtcl_wpnonce",rtcl.__rtcl_wpnonce),e.ajax({url:rtcl.ajaxurl,method:"POST",data:r,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){n.addClass("loading")},success:function(t){n.removeClass("loading"),s.html(""),t.success?(o=t.rawData,c=t.data,s.show(),s.append(c),e("html, body").animate({scrollTop:s.offset().top-25},1e3),i.val(""),i.parent(".custom-file").find(".custom-file-label").text("Choose CSV file...")):(l.text(t.message),l.insertAfter(i).show(),i.closest(".form-group").find(".rtcl-label").css("color","red"))},error:function(t){n.removeClass("loading"),console.log(t)}})):(p="Please, select a csv file! Your selected file is not supported.",l.text(p),l.insertAfter(i).show(),i.closest(".form-group").find(".rtcl-label").css("color","red"))}),e("#rtcl-import-form").validate({submitHandler:function(r){var o=e("#rtcl-import-form").find("#rtcl-import-file")[0].files[0],i=new FileReader;"application/json"===o.type&&(i.onload=function(){var r=n(t().m(function r(n){var o,i,s,c,l;return t().w(function(t){for(;;)switch(t.n){case 0:if(o=JSON.parse(n.target.result),e("#import-response").html(""),i=o.locations,s=o.categories,c=o.settings,l=o.types,!i){t.n=1;break}return t.n=1,a(i,"rtcl_import_location","Location");case 1:if(!s){t.n=2;break}return t.n=2,a(s,"rtcl_import_category","Category");case 2:if(!c){t.n=3;break}return t.n=3,a(c,"rtcl_import_settings","Settings");case 3:if(!l){t.n=4;break}return t.n=4,a(l,"rtcl_import_ad_types","Ad Types");case 4:e(window).bind("beforeunload",function(){alert("Are you sure to close window")});case 5:return t.a(2)}},r)}));return function(t){return r.apply(this,arguments)}}(),i.readAsText(o))}}),e(document).on("submit","#rtcl-listings-import-mapping-form",function(t){t.preventDefault();var r=e(this),n=r.closest(".rtcl-listings-import-mapping-wrapper"),i=r.serialize(),a=r.find("#rtcl_listings_import_submit"),s=e("#rtcl-import-wrap"),c=e(".rtcl-import-notice"),l=e("<div class='rtcl-preloader-dot-loading'><div class='rtcl-cssload-loading'><i></i><i></i><i></i><i></i></div><span>The import process is in progress...</span></div>");e.ajax({url:rtcl.ajaxurl,method:"POST",data:{rows:o,action:"rtcl_import_process_listing_data",formData:i,__rtcl_wpnonce:rtcl.__rtcl_wpnonce},beforeSend:function(){a.attr("disabled",!0),n.append(l),s.find("input").attr("disabled",!0),s.find("button").attr("disabled",!0),c.slideDown(),e("html, body").animate({scrollTop:c.offset().top-25},1e3)},success:function(t){a.attr("disabled",!1),n.find(".rtcl-preloader-dot-loading").remove(),r.remove(),s.find("input").attr("disabled",!1),s.find("button").attr("disabled",!1),c.slideUp(),t.success?n.append("<p class='rtcl-listing-import-response'>"+t.message+"</p>"):n.append("<p class='rtcl-listing-import-response error'>"+t.message+"</p>")},error:function(t,e,o){var i;a.attr("disabled",!1),n.find(".rtcl-preloader-dot-loading").remove(),r.remove(),s.find("input").attr("disabled",!1),s.find("button").attr("disabled",!1),c.slideUp();t.status?(i={400:"Server understood the request, but request content was invalid.",401:"Unauthorized access.",403:"Forbidden resource can't be accessed.",500:"Internal server error.",503:"Service unavailable."}[t.status])||(i=t.responseText):i="parsererror"===o?"Error.\nParsing JSON Request failed.":"timeout"===o?"Request Time out.":"abort"===o?"Request was aborted by the server":t.responseText,n.append("<p class='rtcl-listing-import-response error'>"+i+"</p>"),console.log(o)}})})}}(jQuery)})();